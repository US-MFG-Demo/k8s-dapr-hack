@page "/trafficcontrolservice"
@using DaprTrafficControlWebApp.Shared
@using Microsoft.AspNetCore.SignalR.Client
@using Microsoft.Extensions.Configuration
@inject IConfiguration Configuration
@inject NavigationManager NavigationManager

<FluentButton @onclick="ToggleMonitoring">@MonitoringButtonText</FluentButton>
<hr>
<LogViewer @ref=@logViewer HubConnection=@hubConnection ServiceName=@Configuration["Kubernetes:TrafficControlServiceName"]></LogViewer>

@code {
  private LogViewer logViewer;
  private HubConnection hubConnection;

  protected override void OnInitialized()
  {
    hubConnection = new HubConnectionBuilder()
    .WithUrl(NavigationManager.ToAbsoluteUri(Configuration["Hubs:TrafficControlServiceHubPath"]))
    .Build();
  }
  private void ToggleMonitoring()
  {
    logViewer.ToggleMonitoring();
  }

  private string MonitoringButtonText
  {
    get 
    {
      return logViewer.MonitoringButtonText;
    }
  }
}