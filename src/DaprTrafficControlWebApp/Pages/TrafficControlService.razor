@page "/trafficcontrolservice"
@using DaprTrafficControlWebApp.Shared
@using Microsoft.AspNetCore.SignalR.Client
@using Microsoft.Extensions.Configuration
@inject IConfiguration Configuration
@inject NavigationManager NavigationManager

<FluentButton @onclick="ToggleMonitoring">@MonitoringButtonText</FluentButton>
<hr>
<LogViewer @ref=@logViewer HubConnection=@hubConnection ServiceName="traffic-control-service"></LogViewer>

@code {
  private LogViewer logViewer;
  private HubConnection hubConnection;
  private const string TRAFFIC_CONTROL_SERVICE_HUB_URL = "/trafficcontrolhub";

  protected override void OnInitialized()
  {
    hubConnection = new HubConnectionBuilder()
    .WithUrl(NavigationManager.ToAbsoluteUri(TRAFFIC_CONTROL_SERVICE_HUB_URL))
    .Build();
  }
  private void ToggleMonitoring()
  {
    logViewer.ToggleMonitoring();
  }

  private string MonitoringButtonText
  {
    get 
    {
      return logViewer.MonitoringButtonText;
    }
  }
}